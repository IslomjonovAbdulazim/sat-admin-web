import{j as e,c as E,i as _,r as f,e as z,t as D,B as c,u as I,k as V,L as K}from"./index-F_r_DwTH.js";import{u as O,a as T,T as H,M as Y}from"./top-nav-DvRblSZy.js";import{I as R}from"./input-DMn3TbYb.js";import{S as k,a as M,b as q,c as A,d as j}from"./select-DGKpCF8p.js";import{B as x}from"./badge-DwZHM-eA.js";import{H as $,S as G,T as J,C as U,P as W}from"./config-drawer-BpM_6BIu.js";import{q as L}from"./questions-api-Dx8S8AIK.js";import{m as X}from"./modules-api-Dus87-JM.js";import{D as Z,j as ee,k as se,n as S,m as te,a0 as ae,a1 as le,a2 as re,a3 as ie,a4 as ne,a5 as oe,a6 as ce,a7 as de}from"./sign-out-dialog-XajWXyhp.js";import{F as me}from"./file-text-Bk8UfvQZ.js";import{P as B}from"./plus-Bql6OQ1N.js";import{E as ue,S as Q,T as xe}from"./trash-2-PlYNF6uo.js";import{E as P}from"./eye-pjOTwaeO.js";import{c as he}from"./createLucideIcon-C0SHlZwQ.js";import{D as ge}from"./download-BWAAQZsN.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],F=he("circle-alert",pe),je=_("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function fe({className:l,variant:n,...i}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:E(je({variant:n}),l),...i})}function ve({className:l,...n}){return e.jsx("div",{"data-slot":"alert-description",className:E("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",l),...n})}function Ne({data:l,modules:n,isLoading:i,onEdit:d,onRefresh:a}){const[N,r]=f.useState(!1),[o,m]=f.useState(null),h=z(),u=O({mutationFn:s=>L.delete(s),onSuccess:(s,t)=>{const p=l.find(C=>C.id===t)?.title||"Question";D.success(`${p} deleted successfully`),h.invalidateQueries({queryKey:["questions"]}),h.invalidateQueries({queryKey:["module-questions"]}),r(!1),m(null),a()},onError:s=>{const t=s.response?.data?.detail||"Failed to delete question. Please try again.";D.error(t)}}),y=s=>{m(s),r(!0)},g=()=>{o&&u.mutate(o.id)},v=s=>s==="mcq"?"Multiple Choice":"Fill in the Blank",b=s=>s==="mcq"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700",w=s=>n.find(t=>t.id===s)?.title||`Module #${s}`;return i?e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading questions..."})}):l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(me,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("div",{className:"text-muted-foreground mb-4",children:"No questions found."}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Select a module from the filter above to view its questions or create your first question."}),e.jsxs(c,{onClick:a,children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Create Your First Question"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:l.map(s=>e.jsxs("div",{className:"border rounded-xl p-6 hover:shadow-lg transition-all duration-200 bg-card",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.title}),e.jsx(x,{variant:"outline",className:b(s.type),children:v(s.type)}),e.jsx(x,{variant:"default",children:"Active"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.module?.title||w(s.module?.id||0)})]}),e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsxs(c,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(ue,{className:"h-4 w-4"})]})}),e.jsxs(se,{align:"end",children:[e.jsxs(S,{onClick:()=>{},children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Preview"]}),e.jsxs(S,{onClick:()=>d(s),children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsx(te,{}),e.jsxs(S,{onClick:()=>y(s),className:"text-destructive",children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm mb-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Position:"}),e.jsx("div",{className:"font-medium",children:s.position})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Answer(s):"}),e.jsx("div",{className:"font-medium",children:s.answer.join(", ")})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Type:"}),e.jsx("div",{className:"font-medium",children:v(s.type)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Choices:"}),e.jsx("div",{className:"font-medium",children:s.type==="mcq"?s.choices?.length||0:"N/A"})]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Content Preview:"}),e.jsx("div",{className:"text-sm text-muted-foreground line-clamp-3",children:s.content_markdown.replace(/\*\*/g,"").replace(/\n/g," ")})]}),s.type==="mcq"&&s.choices&&s.choices.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Choices:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:s.choices.slice(0,4).map((t,p)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(x,{variant:"outline",className:"w-8 justify-center",children:t.label}),e.jsx("span",{className:"text-muted-foreground line-clamp-1",children:t.content_markdown.replace(/\*\*/g,"")})]},p))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{},children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Preview"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>d(s),children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Edit"]})]})]},s.id))}),e.jsx(ae,{open:N,onOpenChange:r,children:e.jsxs(le,{children:[e.jsxs(re,{children:[e.jsx(ie,{children:"Delete Question"}),e.jsxs(ne,{children:['Are you sure you want to delete "',o?.title,'"? This will perform a soft delete and the question can be restored later.']})]}),e.jsxs(oe,{children:[e.jsx(ce,{disabled:u.isPending,children:"Cancel"}),e.jsx(de,{onClick:g,disabled:u.isPending,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:u.isPending?"Deleting...":"Delete"})]})]})})]})}function ye(){const l=I(),n=V({strict:!1}),[i,d]=f.useState(""),[a,N]=f.useState(n.moduleId||"none"),[r,o]=f.useState("all"),{data:m=[]}=T({queryKey:["modules"],queryFn:()=>X.list()}),{data:h=[],isLoading:u,refetch:y}=T({queryKey:["questions",a],queryFn:()=>a==="none"?[]:L.getByModuleId(parseInt(a)),enabled:a!=="none"}),g=h.filter(t=>{const p=t.title.toLowerCase().includes(i.toLowerCase()),C=r==="all"||t.type===r;return p&&C}),v=t=>{console.log("Edit question:",t.title)},b=()=>{y()},w=t=>{N(t),d(""),o("all"),l(t!=="none"?{to:"/tests/questions",search:{moduleId:t}}:{to:"/tests/questions",search:{}})},s=t=>t==="mcq"?"Multiple Choice":"Fill in the Blank";return e.jsxs(e.Fragment,{children:[e.jsxs($,{children:[e.jsx(H,{links:be}),e.jsxs("div",{className:"ms-auto flex items-center space-x-4",children:[e.jsx(G,{}),e.jsx(J,{}),e.jsx(U,{}),e.jsx(W,{})]})]}),e.jsxs(Y,{children:[e.jsxs("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"Questions Management"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Create and manage individual test questions with multiple choice or fill-in-the-blank formats"})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx(c,{asChild:!0,size:"lg",className:"bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary/80 shadow-lg hover:shadow-xl transition-all duration-200",disabled:a==="none",children:e.jsxs(K,{to:"/tests/questions/create",search:a!=="none"?{moduleId:a}:{moduleId:void 0},children:[e.jsx(B,{className:"mr-2 h-5 w-5"}),"Add Question"]})})})]}),a==="none"&&e.jsxs(fe,{className:"mb-6 border-amber-200 bg-amber-50 text-amber-800",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx(ve,{children:"Please select a module to view and manage questions. You must choose a specific module to see its questions."})]}),e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(R,{placeholder:a==="none"?"Select a module first to search questions...":"Search questions...",value:i,onChange:t=>d(t.target.value),className:"w-full",disabled:a==="none"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(k,{value:a,onValueChange:w,children:[e.jsx(M,{className:"w-[180px]",children:e.jsx(q,{placeholder:"Select Module"})}),e.jsxs(A,{children:[e.jsx(j,{value:"none",children:"Select Module..."}),m.map(t=>e.jsx(j,{value:t.id.toString(),children:t.title},t.id))]})]}),e.jsxs(k,{value:r,onValueChange:o,disabled:a==="none",children:[e.jsx(M,{className:"w-[140px]",children:e.jsx(q,{placeholder:"All Types"})}),e.jsxs(A,{children:[e.jsx(j,{value:"all",children:"All Types"}),e.jsx(j,{value:"mcq",children:"Multiple Choice"}),e.jsx(j,{value:"fill_blank",children:"Fill in Blank"})]})]}),e.jsxs(c,{variant:"outline",size:"sm",disabled:a==="none"||g.length===0,children:[e.jsx(ge,{className:"h-4 w-4"}),"Export"]})]})]}),a!=="none"&&(i||r!=="all")&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-6",children:[e.jsxs("span",{children:["Showing ",g.length," of ",h.length," questions"]}),i&&e.jsxs(x,{variant:"secondary",children:['Search: "',i,'"']}),e.jsxs(x,{variant:"secondary",children:["Module: ",m.find(t=>t.id.toString()===a)?.title]}),r!=="all"&&e.jsxs(x,{variant:"secondary",children:["Type: ",s(r)]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>{d(""),o("all")},children:"Clear filters"})]}),a!=="none"&&e.jsx(Ne,{data:g,modules:m,isLoading:u,onEdit:v,onRefresh:b}),a==="none"&&e.jsxs("div",{className:"text-center py-16",children:[e.jsx(F,{className:"mx-auto h-16 w-16 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Select a Module to View Questions"}),e.jsx("div",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Questions are organized by modules. Please select a specific module from the dropdown above to view and manage its questions."}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"You can also create questions directly within a selected module."})]})]})]})}const be=[{title:"Tests",href:"/tests/tests",isActive:!1,disabled:!1},{title:"Modules",href:"/tests/modules",isActive:!1,disabled:!1},{title:"Questions",href:"/tests/questions",isActive:!0,disabled:!1}],_e=ye;export{_e as component};
